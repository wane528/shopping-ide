---
// src/components/article/ShareButtons.astro
interface Props {
  title: string;
  slug: string;
  description?: string;
}

const { title, slug, description = '' } = Astro.props;
const siteUrl = 'https://www.puracatcare.help';
const articleUrl = `${siteUrl}/${slug}`;
const encodedUrl = encodeURIComponent(articleUrl);
const encodedTitle = encodeURIComponent(title);
const encodedDesc = encodeURIComponent(description.slice(0, 100));
---

<div class="flex items-center gap-3">
  <span class="text-body-s text-gray-500 dark:text-gray-400 font-medium">Share:</span>
  
  <!-- Twitter/X -->
  <a
    href={`https://twitter.com/intent/tweet?text=${encodedTitle}&url=${encodedUrl}`}
    target="_blank"
    rel="noopener noreferrer"
    class="inline-flex items-center justify-center w-9 h-9 rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-gray-900 hover:text-white dark:hover:bg-white dark:hover:text-gray-900 transition-colors"
    aria-label="Share on X (Twitter)"
    title="Share on X"
  >
    <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor">
      <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
    </svg>
  </a>

  <!-- Facebook -->
  <a
    href={`https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}`}
    target="_blank"
    rel="noopener noreferrer"
    class="inline-flex items-center justify-center w-9 h-9 rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-[#1877F2] hover:text-white transition-colors"
    aria-label="Share on Facebook"
    title="Share on Facebook"
  >
    <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor">
      <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
    </svg>
  </a>

  <!-- Copy Link -->
  <button
    id="copy-link-btn"
    data-url={articleUrl}
    class="inline-flex items-center justify-center w-9 h-9 rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-primary-600 hover:text-white transition-colors"
    aria-label="Copy link"
    title="Copy link"
  >
    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
    </svg>
  </button>
</div>

<script>
  const copyBtn = document.getElementById('copy-link-btn');
  copyBtn?.addEventListener('click', async () => {
    const url = copyBtn.getAttribute('data-url') || window.location.href;
    try {
      await navigator.clipboard.writeText(url);
      const originalHtml = copyBtn.innerHTML;
      copyBtn.innerHTML = '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>';
      copyBtn.classList.add('bg-green-500', 'text-white');
      setTimeout(() => {
        copyBtn.innerHTML = originalHtml;
        copyBtn.classList.remove('bg-green-500', 'text-white');
      }, 2000);
    } catch {
      // fallback
      const input = document.createElement('input');
      input.value = url;
      document.body.appendChild(input);
      input.select();
      document.execCommand('copy');
      document.body.removeChild(input);
    }
  });
</script>
